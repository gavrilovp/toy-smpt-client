30 вариант
poll и единственный рабочий поток (или процесс).
Журналирование в отдельном процесе.
Пытаться отправлять все сообщения для одного MX за одну сессию.